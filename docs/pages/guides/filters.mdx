import { Markdown } from '../../components/Page';

# GraphQL Queries - Filters

Keystone provides a powerful GraphQL API for querying the data in your system.
At the core of this system are **query filters**.

In this guide we'll show you how to use filters to find data in your system.

This guide uses the schema defined in the [Task Manager](FIXME) example project.

## Scalar Filters

If we want to find all the `Tasks` in our system, we can use the query `allTasks()`.

```graphql
{
  allTasks {
    id
    label
  }
}
```

In general we don't want to grab all the tasks at once, but want to find a particular set of tasks which match a particular condition.
In Keystone we can do this by passing a `where` argument to the `allTasks()` query.

If we want to find all the tasks with a label equal to `"Hello"` we can write:

```graphql
{
  allTasks(where: { label: "Hello" }) {
    id
    label
  }
}
```

Keystone provides a wide range of different filters. If we want to find all those those tasks which **don't** have a label of `"Hello"` we can write:

```graphql
{
  allTasks(where: { label_not: "Hello" }) {
    id
    label
  }
}
```

The `text()` field type also supports searching for sub-strings within a field:

```graphql
{
  allTasks(where: { label_contains: "He" }) {
    id
    label
  }
}
```

Different field types support different filters. The field `finishBy: timestampe()`, for example, lets you filter by tasks with a due date after a particular date:

```graphql
{
  allTasks(where: { finishBy_gt: "2022-01-01T00:00:00.000Z" }) {
    id
    label
  }
}
```

For a full list of the different filters provided by each field type, please check the [Query Filter API](../apis/filters).

For more complex queries, you can combine multiple queries at once, and only those items which match all queries will be returned.

```graphql
{
  allTasks(where: {
    label_contains: "He",
    finishBy_gt: "2022-01-01T00:00:00.000Z"
  }) {
    id
    label
  }
}
```

## Combined Filters

For more advanced queries, you might need to explicitly combine different queries.
The `AND` operater accepts a list of sub-queries, and will only return those items which match all of these sub-queries.

```graphql
{
  allTasks(where: { AND: [
    { label_contains: "H" },
    { label_contains: "ll" }
  ] }) {
    id
    label
  }
}
```

The `OR` operater accepts a list of sub-queries, and will only return those items which match at least one of these sub-queries.

```graphql
{
  allTasks(where: { OR: [
    { label_contains: "H" },
    { label_contains: "ll" }
  ] }) {
    id
    label
  }
}
```

## Relationship Filters

As well as filtering by scalar fields, you can also filter against relationships.
Relationship filters will depend on whether you have `many: true` or `many: false` on the field.

### One

If you have `many: false` configured on the relationship field, then you can find items based on

```graphql
{
  allTasks(where: { assignedTo: { name: "Alice" } }) {
    id
    label
  }
}
```

### Many

export default ({ children }) => <Markdown>{children}</Markdown>;
