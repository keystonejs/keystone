import { Markdown, getStaticProps } from '../../components/Markdown';
import { Emoji } from '../../components/primitives/Emoji';

# Release: 1st November 2021

Live reloading is now available in Keystone! <Emoji symbol="🚀" alt="Rocket" /> Plus more updates as we finalise the Keystone 6 GA release.

```json
"@keystone-next/keystone": "x.x.x",
```
## Live Reloading <Emoji symbol="🚀" alt="Rocket" />

Keystone now supports live reloading via `keystone-next dev`!

You can now update your GraphQL schema, log errors and see how your data returns, then immediately use the playground to test it and iterate.

We feel this is an absolute game changer when developing with Keystone.

## GraphQL Playground and Apollo Sandbox <Emoji symbol="⏪" alt="Reverse" />

In the last release we upgraded to Apollo Server 3 which brought Apollo Sandbox as the default development UI for testing your GraphQL queries.

This brought a number of issues as **Apollo Sandbox** is hosted remotely rather than locally, which surfaced CORs error among others.

With this in mind, Keystone will now go back to using the **GraphQL Playground** by default instead of **Apollo Sandbox** as it did prior to updating to Apollo Server 3.

If you want to use **Apollo Sandbox**, you can set `graphql.playground: 'apollo'` to use Apollo.

`graphql.playground` defaults to `process.env.NODE_ENV !== 'production'`, which will serve **GraphQL Playground** in development and serve nothing in production, if you'd like to set it to one of those always, you can set `graphql.playground` to a boolean explicitly.

## CORS Configuration <Emoji symbol="🌐" alt="World" />

We've removed the `graphql.cors` option, we had one too many ways to configure CORS and it was proving to be confusing.

You should now exclusively configure `cors` with the `server.cors` option.

## Relationship Filtering <Emoji symbol="❤️" alt="Heart" />

If you have hundreds of items in your relationship fields, the Admin UI was sometimes displaying duplicate entries and/or missing entries.

We've made a series of improvements to fetching data resulting in a performance boost, as well as filtering fixes. We also changed the way we detect when an ID is pasted into the field allowing you to select a related item quickly.

## Removed `resolveFields` <Emoji symbol="🚧" alt="Construction" />

The deprecated `resolveFields` from `context.query` has been removed.

If you were still using it, you should switch to providing `the query option` to `context.query` or use `context.db` if you were providing `false`.

The `context.query` functions will now also throw an error if an empty string is passed to `query` rather than silently returning what the `context.db` functions return, you must select at least one field or omit the `query` option to default to selecting the `id`.

## Internal types renamed <Emoji symbol="✏️" alt="Pencil" />

We have updated `@graphql-ts/schema` to `0.5.0`.

The `__rootVal` properties on `ObjectType`, `InterfaceType` and `UnionType` have been renamed to `__source`, this is intended to be internal but you may have depended on it, if you were using it, rename `__rootVal` to `__source`.

In addition the `fields` property on `InterfaceType` has been renamed to `__fields` and it will no longer exist at runtime like the other types.

## GraphQL Schema Reorder <Emoji symbol="🛗" alt="Elevator" />

The way the `endSession` field on the `Mutation` type and the `keystone` field on the `Query` type have been adjusted. This may result in re-ordering in your generated `schema.graphql` file. The `sessionSchema` export of `@keystone-next/keystone/session` has also been removed.

## Miscellaneous Fixes <Emoji symbol="⚙️" alt="Gear" />

- `context.session` no longer has a value if the session is invalid.
- `text`, `integer`, `float` and `decimal` on the item view when using `ui.itemView.fieldMode: 'read'` now render correctly.
- Admin UI home page now respects `ui.hideCreate` and won't show a plus button when create is disabled.
- Read only arrays are now accepted where previously mutable arrays were required. This means that if you use `as const` when writing an array and then pass it to various APIs in Keystone, that will now work.
- Fixed bug in `LinkToRelatedItems` button for double sided relationships.

## Prisma Update <Emoji symbol="🗃" alt="Card File Box" />

We've updated our Prisma dependency from `3.1.1` to `3.3.0`!

Check out the [Prisma releases page](https://github.com/prisma/prisma/releases) for more details.

## Credits <Emoji symbol="💫" alt="Circle Star" />

- Added a short plain-text display to `document` fields in the `List` view as well as a rendered document view in `CardValue`. Thanks [@oplik0](https://github.com/oplik0)!

## Complete Changelog <Emoji symbol="📜" alt="Scroll" />

You can also view the [verbose release notes](https://github.com/keystonejs/keystone/pull/6762) for this release on GitHub.

export default ({ children, ...props }) => <Markdown description="2021-10-05" {...props}>{children}</Markdown>;
export { getStaticProps }
