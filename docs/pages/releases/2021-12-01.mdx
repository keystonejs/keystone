import { Markdown, getStaticProps } from '../../components/Markdown';
import { Emoji } from '../../components/primitives/Emoji';
import { Stack } from '../../components/primitives/Stack';

# Release: 1st December 2021

Keystone 6 has hit **General Availability**! We've shipped several more quality of life updates since our release candidate last week. <Emoji symbol="🚀" alt="Rocket"/>

Check out our [general availability update](/updates/general-availability) and our updated [roadmap](/updates/roadmap).

With this release, the project has moved to the `@keystone-6` namespace on npm. We highly recommend you upgrade your existing **Keystone Next** projects to **Keystone 6** with the packages below:

```json
"@keystone-6/keystone": "1.0.0",
```

## Keystone 6 <Emoji symbol="⚡️" alt="Lightning" />

We've graduated to the `@keystone-6` namespace on npm, as such our version numbers have been reset for this major release.

Among other internal naming changes, our CLI commands have switched from `keystone-next` to simply `keystone`, please ensure you update your startup scripts to suit!

## Type Enhancements <Emoji symbol="✨" alt="Sparkles" />

We've shipped a significant update to our type generation.

If you're implementing a custom field or are using specific types for certain fields, you're going to see types being better, the biggest impact is when `KeystoneContext` is used.

Generated types are now more usable and convenient. Prior to this release, the generated types were only usable to cast the `KeystoneContext` to one with the query, DB, or Prisma fields to a specific version, not being very user friendly.

Now, for example, if you want to write all your lists in one big object:

```ts
import { Lists } from '.keystone/lists'

export const lists: Lists = {
  Blah: list({...})
}
```

Hooks, access control and so forth will accept things like a context with query, DB, and Prisma fields typed exactly, for example the `item` parameter in hooks.

If you're defining your lists separately, you can do this:

```ts
import { Lists } from '.keystone/lists'

export const Blah: Lists.Blah = list({
  ...
})
```

Note the `.Blah` rather than `["Blah"]`, `Lists` is both a type alias and a namespace.

`Lists.Blah` and `Lists["Blah"]` mean different things, `Lists["Blah"]` is essentially `Lists.Blah | undefined` because all the properties on `Lists` are optional.

This allows you to define lists in one file and more in another.

For a more in-depth view of what's been changed, see below:

- The following types have been renamed:
  - `BaseGeneratedListTypes` → `BaseListTypeInfo`
  - `ItemRootValue` → `BaseItem`
  - `ListInfo` → `ListGraphQLTypes`
  - `TypesForList` → `GraphQLTypesForList`
  - `FieldTypeFunc` now has a required type parameter which must satisfy `BaseListTypeInfo`
  - The following types now have a required type parameter which must satisfy `BaseKeystoneTypeInfo`:
    - `ServerConfig`
    - `CreateRequestContext`
    - `AdminUIConfig`
    - `DatabaseConfig`
    - `ListOperationAccessControl`
    - `MaybeSessionFunction`
    - `MaybeItemFunction`
- `GraphQLResolver` and `GraphQLSchemaExtension` now have a required type parameter which must satisfy `KeystoneContext`
- `KeystoneGraphQLAPI` no longer has a type parameter
- The first parameter to the resolver in a `virtual` field will be typed as the item type if the list is typed with `Keystone.Lists` or `Keystone.Lists.ListKey`, otherwise it will be typed as `unknown`
- The `item`/`originalItem` arguments in hooks/access control will now receive the `Item` type if the list is typed with `Keystone.Lists` or `Keystone.Lists.ListKey`, otherwise it will be typed as `BaseItem`
- `args` has been removed from `BaseListTypeInfo`
- `inputs.orderBy` and `all` has been added to `BaseListTypeInfo`
- In `.keystone/types`:
  - `ListKeyListTypeInfo` has been moved to `Lists.ListKey.TypeInfo`
  - `KeystoneContext` has been renamed to `Context`

## Credits <Emoji symbol="💫" alt="Circle Star" />

This release would not have been possible without the support and feedback of such an awesome developer community.

We’re grateful for the ideas you bring, the help you give others, and the code contributions the you’ve made to get Keystone to where it is today.

!> Like this release? [Give us a star](https://github.com/keystonejs/keystone) on GitHub!

## Complete Changelog <Emoji symbol="📜" alt="Scroll" />

You can also view the [verbose release notes](https://github.com/keystonejs/keystone/pull/7018) for this release on GitHub.

export default ({ children, ...props }) => (
  <Markdown
    description="Keystone 6 has hit **General Availability**! We've shipped several more improvements since our release candidate last week."
    {...props}
  >
    {children}
  </Markdown>
);
export { getStaticProps };
